mode: rule # è§„åˆ™æ¨¡å¼ï¼šruleï¼ˆè§„åˆ™ï¼‰ / globalï¼ˆå…¨å±€ä»£ç†ï¼‰/ directï¼ˆå…¨å±€ç›´è¿ï¼‰
log-level: info # silent / info / warning / error / debug
allow-lan: true # å…è®¸å±€åŸŸç½‘çš„è¿æ¥ï¼ˆå…±äº«ä»£ç†ï¼‰
bind-address: "*" # ç›‘å¬IPç™½åå•ï¼Œå¯ç»‘å®šå•ä¸ªIPv4å’Œv6åœ°å€ï¼Œ"*" ä¸ºç»‘å®šæ‰€æœ‰IPåœ°å€ï¼Œä»…åœ¨å°†allow-lanè®¾ç½®ä¸ºtrueæ—¶é€‚ç”¨
ipv6: true # å¼€å¯ IPv6 æ€»å¼€å…³ï¼Œå…³é—­é˜»æ–­æ‰€æœ‰ IPv6 é“¾æ¥å’Œå±è”½ DNS è¯·æ±‚ AAAA è®°å½•
udp: true # æ˜¯å¦å…è®¸ UDP é€šè¿‡ä»£ç†ï¼Œé»˜è®¤ä¸º false

unified-delay: true # å¼€å¯ç»Ÿä¸€å»¶è¿Ÿæ—¶ï¼Œä¼šè¿›è¡Œä¸¤æ¬¡å»¶è¿Ÿæµ‹è¯•ï¼Œä»¥æ¶ˆé™¤è¿æ¥æ¡æ‰‹ç­‰å¸¦æ¥çš„ä¸åŒç±»å‹èŠ‚ç‚¹çš„å»¶è¿Ÿå·®å¼‚ï¼Œå¯é€‰å€¼ true/false
tcp-concurrent: true # TCP å¹¶å‘
find-process-mode: "off" # è·¯ç”±å™¨æ¨è off å…³é—­è¿›ç¨‹åŒ¹é…
global-client-fingerprint: random # éšæœºå…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹
profile:
  store-selected: true # å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©ï¼Œä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨
  store-fake-ip: true # å‚¨å­˜ fakeip æ˜ å°„è¡¨ï¼ŒåŸŸåå†æ¬¡å‘ç”Ÿè¿æ¥æ—¶ï¼Œä½¿ç”¨åŸæœ‰æ˜ å°„åœ°å€

external-controller: :9090 # clash çš„ RESTful API ç›‘å¬åœ°å€
# external-controller-tls: :9443
# tls:
#   certificate: string # è¯ä¹¦ PEM æ ¼å¼ï¼Œæˆ–è€… è¯ä¹¦çš„è·¯å¾„
#   private-key: string # è¯ä¹¦å¯¹åº”çš„ç§é’¥ PEM æ ¼å¼ï¼Œæˆ–è€…ç§é’¥è·¯å¾„
external-ui: ui
external-ui-url: "https://mirror.ghproxy.com/https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"
secret: hkvmQ7ZPgdbnheJVs45e

mixed-port: 7890 # HTTP(S) and SOCKS5 å…±ç”¨ç«¯å£
port: 7891 # HTTP ä»£ç†ç«¯å£
socks-port: 7892 # SOCKS5 ä»£ç†ç«¯å£
authentication:
  - vkmJQ7:hheZVs45ePgdbn
# skip-auth-prefixes:
#   - 192.168.8.0/24
redir-port: 7893 # Linux å’Œ macOS çš„ redir é€æ˜ä»£ç†ç«¯å£ (é‡å®šå‘ TCP å’Œ TProxy UDP æµé‡)
tproxy-port: 7894 # Linux çš„é€æ˜ä»£ç†ç«¯å£ï¼ˆé€‚ç”¨äº TProxy TCP å’Œ TProxy UDP æµé‡)

geodata-mode: false # é»˜è®¤å€¼ false
geodata-loader: memconservative # GEO æ–‡ä»¶åŠ è½½æ¨¡å¼ï¼Œstandardï¼šæ ‡å‡†åŠ è½½å™¨ memconservativeï¼šä¸“ä¸ºå†…å­˜å—é™ (å°å†…å­˜) è®¾å¤‡ä¼˜åŒ–çš„åŠ è½½å™¨ (é»˜è®¤å€¼)
geo-auto-update: true # è‡ªåŠ¨æ›´æ–° GEO
geo-update-interval: 24 # æ›´æ–°é—´éš”ï¼Œå•ä½ä¸ºå°æ—¶
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"
  asn: "https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"
# https://github.com/misakaio/chnroutes2/tree/master
# routing-mark: 6666
# tun:
#   enable: true
#   stack: gvisor # tun æ¨¡å¼å †æ ˆ,å¯ç”¨å€¼ï¼šsystem/gvisor/mixed
#   device: Mihomo
#   mtu: 1500
#   dns-hijack:
#     - "any:53"
#   auto-route: true # è‡ªåŠ¨è®¾ç½®å…¨å±€è·¯ç”±ï¼Œå¯ä»¥è‡ªåŠ¨å°†å…¨å±€æµé‡è·¯ç”±è¿›å…¥ tun ç½‘å¡
#   auto-detect-interface: true # è‡ªåŠ¨é€‰æ‹©æµé‡å‡ºå£æ¥å£ï¼Œå¤šå‡ºå£ç½‘å¡åŒæ—¶è¿æ¥çš„è®¾å¤‡å»ºè®®æ‰‹åŠ¨æŒ‡å®šå‡ºå£ç½‘å¡
#   strict-route: true

# DNS æœåŠ¡å™¨å’Œå»ºç«‹è¿æ¥æ—¶çš„ é™æ€ Hosts, ä»…åœ¨ dns.enhanced-mode æ¨¡å¼ä¸º redir-host ç”Ÿæ•ˆ
# æ”¯æŒé€šé…ç¬¦åŸŸå (ä¾‹å¦‚: *.clash.dev, *.foo.*.example.com )
# ä¸ä½¿ç”¨é€šé…ç¬¦çš„åŸŸåä¼˜å…ˆçº§é«˜äºä½¿ç”¨é€šé…ç¬¦çš„åŸŸå (ä¾‹å¦‚: foo.example.com > *.example.com > .example.com )
# hosts:
# '*.clash.dev': 127.0.0.1
# '.dev': 127.0.0.1
# 'alpha.clash.dev': '::1'
# 'dnslog.cn: 47.244.138.18'
# unified-delay: true
# dnslog.cn: 47.244.138.18
# DNS æœåŠ¡å™¨é…ç½®(å¯é€‰ï¼›è‹¥ä¸é…ç½®ï¼Œç¨‹åºå†…ç½®çš„ DNS æœåŠ¡ä¼šè¢«å…³é—­)
dns:
  enable: true
  prefer-h3: true
  # å¯¹äºæ”¯æŒ http3 çš„ Doh ä¼šå¯åŠ¨å¹¶å‘æŸ¥è¯¢ï¼Œå¦‚æœå¯¹æ–¹æ”¯æŒï¼Œé€Ÿåº¦æ›´å¿«ï¼Œé‚£å°±èµ·é£
  # dns over HTTP3 ä¼šæ¯” doH è¦å¿«ã€‚
  ipv6: false # å½“æ­¤é€‰é¡¹ä¸º false æ—¶, AAAA è¯·æ±‚å°†è¿”å›ç©º
  listen: :1053
  enhanced-mode: redir-host
  use-hosts: true
  use-system-hosts: true
  # ä»¥ä¸‹å¡«å†™çš„ DNS æœåŠ¡å™¨å°†ä¼šè¢«ç”¨æ¥è§£æ DNS æœåŠ¡çš„åŸŸå
  # ä»…å¡«å†™ DNS æœåŠ¡å™¨çš„ IP åœ°å€
  default-nameserver:
    - 8.8.8.8
    - 1.1.1.1
  # æ‰€æœ‰ DNS è¯·æ±‚å°†ä¼šç›´æ¥å‘é€åˆ°æœåŠ¡å™¨ï¼Œä¸ç»è¿‡ä»»ä½•ä»£ç†ã€‚
  # å¹¶å‘æŸ¥è¯¢è·å–æœ€å…ˆè¿”å›çš„ç»“æœ
  nameserver:
    - https://dns.google/dns-query
    - https://cloudflare-dns.com/dns-query
  nameserver-policy:
    "geosite:category-ads-all":
      - rcode://success
    "geosite:microsoft@cn,apple-cn,google-cn,category-games@cn,cn,private":
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
# åŸŸåå—…æ¢
sniffer:
  enable: true
  force-dns-mapping: true # å¯¹ redir-host ç±»å‹è¯†åˆ«çš„æµé‡è¿›è¡Œå¼ºåˆ¶å—…æ¢
  parse-pure-ip: true # å¯¹æ‰€æœ‰æœªè·å–åˆ°åŸŸåçš„æµé‡è¿›è¡Œå¼ºåˆ¶å—…æ¢
  override-destination: true # æ˜¯å¦ä½¿ç”¨å—…æ¢ç»“æœä½œä¸ºå®é™…è®¿é—®ï¼Œé»˜è®¤ä¸º true
  # force-domain: #éœ€è¦å¼ºåˆ¶å—…æ¢çš„åŸŸåï¼Œé»˜è®¤åªå¯¹IPå—…æ¢
  #   - "+" #å»æ‰æ³¨é‡Šåç­‰äºå…¨å±€å—…æ¢
  #   - "google.com"
  skip-domain:
    - "Mijia Cloud"
    - "dlg.io.mi.com"
    - "+.apple.com"
  sniff:
    HTTP:
      ports:
        - 80
        - 8080-8880
    TLS:
      ports:
        - 443
        - 8443
    QUIC:
      ports:
        - 443
        - 8443

proxy-providers:
  wow.dogss-host.bond:
    type: http
    url: https://converter.cloudnative.love/api/convert?url=https%3A%2F%2Fwow.dogss-host.bond%2Fapi%2Fv1%2Fclient%2Fsubscribe%3Ftoken%3Db985c9ac1605357a4527da9dd0f92d76&target=clash
    path: ./proxy-providers/wow.dogss-host.bond.yaml
    proxy: DIRECT #ç»è¿‡æŒ‡å®šä»£ç†è¿›è¡Œä¸‹è½½/æ›´æ–°
    interval: 3600
    health-check:
      enable: true
      interval: 600
      lazy: true
      url: http://www.gstatic.com/generate_204
  mojie.app:
    type: http
    url: https://converter.cloudnative.love/api/convert?url=https%3A%2F%2Fmojie.app%2Fapi%2Fv1%2Fclient%2Fsubscribe%3Ftoken%3D8395e62ecd858a83ee36f3e1e687b70a&target=clash
    path: ./proxy-providers/mojie.app.yaml
    proxy: DIRECT #ç»è¿‡æŒ‡å®šä»£ç†è¿›è¡Œä¸‹è½½/æ›´æ–°
    interval: 3600
    health-check:
      enable: true
      interval: 600
      lazy: true
      url: http://www.gstatic.com/generate_204

proxy-groups:
  - name: PROXY
    type: select
    proxies:
      - è‡ªåŠ¨å›é€€
      - è‡ªåŠ¨é€‰æ‹©
      - ğŸ‡­ğŸ‡° Hong Kong
      - ğŸ‡¨ğŸ‡³ Taiwan
      - ğŸ‡¯ğŸ‡µ Japan
      - ğŸ‡¸ğŸ‡¬ Singapore
      - ğŸ‡ºğŸ‡¸ United States
    url: http://cp.cloudflare.com/generate_204
    interval: 300

  - name: è‡ªåŠ¨å›é€€
    type: fallback
    include-all: true
    url: https://www.gstatic.com/generate_204
    interval: 300
  - name: è‡ªåŠ¨é€‰æ‹©
    type: url-test
    include-all: true
    tolerance: 10
    udp: true
  - name: AI
    type: select
    include-all: true
    filter: "(?i)æ¸¯|hk|hongkong|hong kong"
  - name: ğŸ‡­ğŸ‡° Hong Kong
    type: select
    include-all: true
    filter: "(?i)æ¸¯|hk|hongkong|hong kong"
  - name: ğŸ‡¨ğŸ‡³ Taiwan
    type: select
    include-all: true
    filter: "(?i)å°|tw|taiwan"
  - name: ğŸ‡¯ğŸ‡µ Japan
    type: select
    include-all: true
    filter: "(?i)æ—¥|jp|japan"
  - name: ğŸ‡ºğŸ‡¸ United States
    type: select
    include-all: true
    filter: (?i)ç¾|us|unitedstates|united states
  - name: ğŸ‡¸ğŸ‡¬ Singapore
    type: select
    include-all: true
    filter: (?i)(æ–°|sg|singapore)
  - name: å…¶å®ƒåœ°åŒº
    type: select
    include-all: true
    filter: (?i)^(?!.*(?:ğŸ‡­ğŸ‡°|ğŸ‡¯ğŸ‡µ|ğŸ‡ºğŸ‡¸|ğŸ‡¸ğŸ‡¬|ğŸ‡¨ğŸ‡³|æ¸¯|hk|hongkong|å°|tw|taiwan|æ—¥|jp|japan|æ–°|sg|singapore|ç¾|us|unitedstates)).*

rule-providers:
  Bahamut:
    type: http
    behavior: classical
    url: https://http.wwwgovcomr.shop/nus74f89st1/Ba.yml
    interval: 86400
    path: ./ruleset/Bahamut.yml
  ChatGPT:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/G4free/clash-ruleset/main/ruleset/ChatGPT.yaml"
    path: ./ruleset/ChatGPT.yaml
    interval: 86400
rules:
  - GEOSITE,openai,AI
  - RULE-SET,ChatGPT,AI
  - DOMAIN,google.com,PROXY
  - GEOSITE,google,PROXY
  - GEOSITE,github,PROXY
  - GEOSITE,youtube,PROXY
  - GEOSITE,geolocation-!cn,PROXY
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,192.168.0.0/16,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,17.0.0.0/8,DIRECT
  - IP-CIDR,100.64.0.0/10,DIRECT
  - IP-CIDR,224.0.0.0/4,DIRECT
  - IP-CIDR,203.0.113.0/24,DIRECT
  - IP-CIDR,192.0.2.0/24,DIRECT
  - IP-CIDR6,fe80::/10,DIRECT
  - GEOSITE,bilibili,DIRECT
  - GEOSITE,CN,DIRECT,no-resolve
  - GEOIP,LAN,DIRECT,no-resolve
  - GEOIP,CN,DIRECT,no-resolve
  - MATCH,PROXY
